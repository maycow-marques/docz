import { Meta } from "@storybook/blocks";

<Meta title="Introducao" />

# üåü Bem-vindo √† Biblioteca de Componentes

Bem-vindo √† documenta√ß√£o interativa da **Biblioteca de Componentes** do projeto. Aqui, voc√™ encontrar√° todos os componentes dispon√≠veis e como utiliz√°-los corretamente.

## üöÄ Come√ßando

Para instalar as depend√™ncias do projeto e iniciar o Storybook, execute:

```bash
pnpm install
pnpm storybook
```

## üìÇ Organiza√ß√£o dos Componentes

Os componentes s√£o organizados em diferentes categorias, seguindo a estrutura:

```scss
|-üìÇ src/components/
  |-üìÅ forms/                # Formul√°rios
  |-üìÅ layouts/              # Sess√µes reutiliz√°veis
  |-üìÅ providers/            # Componentes que compartilham estados
  |-üìÅ tables/               # Componentes relacionados a tabelas
  |-üìÅ ui/                   # Componentes at√¥micos
    |-üìÅ Button/
      |-üìñ index.stories.tsx
      |-‚öõÔ∏è index.tsx
    |-üìÅ Dropdown/
      |-‚öõÔ∏è Dropdown.tsx
      |-üìö Dropdown.stories.tsx
      |-‚öõÔ∏è DropdownItem.tsx
      |-‚öõÔ∏è index.ts         # Ambos devem ser exportados daqui
```

### üîß Padr√£o de Organiza√ß√£o

Esta estrutura segue um **padr√£o hier√°rquico**, garantindo que **componentes filhos** permane√ßam dentro do contexto de seus **componentes pais**, caso n√£o sejam reutilizados globalmente. Isso ajuda na **organiza√ß√£o do c√≥digo**, evita polui√ß√£o de pastas e melhora a manuten√ß√£o.

#### üîπ **Quando essa estrutura √© ideal?**
- O **componente filho** √© usado **somente dentro do pai** (exemplo: `DropdownItem` s√≥ faz sentido dentro de `Dropdown`).
- Mant√©m a estrutura organizada e f√°cil de navegar.
- Evita a necessidade de importar componentes filhos em locais desnecess√°rios.

#### üîπ **Quando mover para um local mais gen√©rico?**
- Se um **componente filho for reutilizado** em outros lugares, ele deve ser movido para `src/components/ui`.
- Exemplo: Se `DropdownItem` for usado fora do `Dropdown`, ele deveria estar em `src/components/ui/DropdownItem.tsx`.

### üé® Reexportando Componentes Filhos
Para evitar importa√ß√µes longas e garantir encapsulamento, os componentes filhos podem ser **reexportados via `index.ts` do pai**:
```tsx
// src/components/ui/Dropdown/index.ts
export { Dropdown } from "./Dropdown";
export { DropdownItem } from "./DropdownItem";
```

Dessa forma, a importa√ß√£o fica mais simples:
```tsx
import { Dropdown, DropdownItem } from "@/components/ui/Dropdown";
```

## üåê Testes no Storybook
O Storybook permite testar intera√ß√µes nos componentes usando a API `play()`, `userEvent` e `within` da Testing Library.

### üîç Teste de clique em bot√£o
‚úÖ Esse teste localiza o bot√£o dentro do Storybook e simula um clique.

```tsx
export const Default: Story = {
  args: {
    variant: "primary",
  },
  play: async ({ canvasElement }) => {
    const canvas = within(canvasElement);
    const button = await canvas.findByRole("button", { name: /clique aqui/i });
    await userEvent.click(button);
  },
};
```

### üîç Teste de formul√°rio no Storybook
‚úÖ Simula um usu√°rio preenchendo um formul√°rio e clicando no bot√£o de login.

```tsx
import { userEvent, within } from "@storybook/testing-library";
import { LoginForm } from "./LoginForm";

export const Default = {
  args: {},
  play: async ({ canvasElement }) => {
    const canvas = within(canvasElement);
    await userEvent.type(canvas.getByLabelText("E-mail"), "teste@email.com");
    await userEvent.type(canvas.getByLabelText("Senha"), "123456");
    await userEvent.click(canvas.getByRole("button", { name: /entrar/i }));
  },
};
```


## üîå Plugins Recomendados para VSCode
Para melhorar a experi√™ncia de desenvolvimento, recomendamos instalar os seguintes plugins no Visual Studio Code:

<table>
  <thead>
    <tr>
      <th>Plugin</th>
      <th>Descri√ß√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MDX</td>
      <td>Suporte aprimorado para arquivos .mdx</td>
    </tr>
    <tr>
      <td>ESLint</td>
      <td>Integra√ß√£o com ESLint para melhor linting</td>
    </tr>
    <tr>
      <td>i18n Ally</td>
      <td>Ferramenta para gerenciar tradu√ß√µes i18n</td>
    </tr>
    <tr>
      <td>Auto Close Tag</td>
      <td>Fecha automaticamente a tag</td>
    </tr>
    <tr>
      <td>Auto Rename Tag</td>
      <td>Renomeia automaticamente a tag de fechamento ao alterar a de abertura</td>
    </tr>
    <tr>
      <td>Tailwind CSS IntelliSense</td>
      <td>Sugest√µes inteligentes para Tailwind CSS</td>
    </tr>
    <tr>
      <td>JavaScript (ES6) Code Snippets</td>
      <td>Snippets √∫teis para ES6+</td>
    </tr>
  </tbody>
</table>

### ‚öôÔ∏è Configura√ß√µes Recomendadas
Adicione as seguintes configura√ß√µes no settings.json para melhorar a produtividade:

```json
{
    "tailwindCSS.files.exclude": [
        "**/.hg/**",
        "**/.svn/**",
        "**/.git/**",
        "**/.next/**",
        "**/.vscode/**",
        "**/messages/**",
        "**/.storybook/**",
        "**/node_modules/**"
    ],
    "tailwindCSS.emmetCompletions": true,
    "tailwindCSS.experimental.classRegex": [
        [
            "tv\\(([^)]*)\\)",
            "[\"'`]([^\"'`]*).*?[\"'`]"
        ]
    ],
    "editor.tabSize": 2,
    "editor.insertSpaces": true,
    "editor.formatOnPaste": false, 
    "editor.formatOnSave": false,
    "editor.codeActionsOnSave": { 
        "source.fixAll": "always"
    }
}
```

## üìå Padr√µes de C√≥digo
Para manter a consist√™ncia e a qualidade do c√≥digo, siga estas diretrizes abaixo:

### 1Ô∏è‚É£ Componentes
- Devem ser exportados de forma nomeada para facilitar a refatora√ß√£o e a manuten√ß√£o.
- Devem ser funcionais (N√£o usar Class nem Arrow Functions).
- O nome dos componentes devem ser em **PascalCase**.
- Os componentes devem ser tipados corretamente, priorizando a **extens√£o** das propriedades **do elemento HTML principal**.

#### ‚úî Vantagens dessa abordagem:

- Componentes utilizando fun√ß√µes (Function Declaration):
  - Melhor legibilidade e debugging: O React DevTools exibe corretamente o nome do componente.
  - Melhor suporte a hooks: Hooks como useState e useEffect funcionam apenas dentro de componentes funcionais.
  - Mais perform√°tico: Componentes funcionais s√£o otimizados pelo React e n√£o sofrem com problemas de this.
  - Mais conciso e moderno: Reduz a verbosidade do c√≥digo e facilita a manuten√ß√£o.
  - Compatibilidade com memoiza√ß√£o: Funciona melhor com React.memo() para otimiza√ß√£o de renderiza√ß√£o.
- Componentes estendendo elemento HTML principal:
  - Permite passar propriedades nativas do HTML (className, id, data-* attributes, etc.).
  - Facilita o uso do ref quando necess√°rio.
  - Mant√©m o c√≥digo organizado e f√°cil de entender.

#### Exemplos

```tsx
// ‚ùå ERRADO - N√£o utilizar arrow functions
export const Button = () => <button>Click me</button>

// ‚ùå ERRADO - N√£o utilizar exporta√ß√£o default
export default function Button() {
  return <button>Click me</button>;
}

// ‚ùå ERRADO - N√£o utilizar classes para componentes
export class Button extends React.Component {
  render() {
    return <button>Click me</button>;
  }
}

// ‚úÖ CORRETO - Sempre exportar de forma nomeada
export function Button() {
  return <button>Click me</button>;
}
```

```tsx
import { DetailedHTMLProps, HTMLAttributes, ReactNode } from "react";

type BaseProps = DetailedHTMLProps<HTMLAttributes<HTMLDivElement>, HTMLDivElement>;

type AccordionProps = BaseProps & {
  title: string;
  isOpen?: boolean;
  children: ReactNode;
  onToggle?: () => void;
};

export function Accordion({ title, isOpen, children, onToggle, ...rest }: AccordionProps) {
  return (
    <div {...rest}>
      <button onClick={onToggle}>{title}</button>
      {isOpen && <div>{children}</div>}
    </div>
  );
}
```

## üåç Snippets
Aqui est√£o alguns snippets para agilizar o desenvolvimento de componentes no projeto:

### üîñ Criar um componente de formul√°rio
```json
"Creates a Form component": {
  "prefix": "component:form",
  "body": [
    "\"use client\";",
    "",
    "import { zodResolver } from \"@hookform/resolvers/zod\";",
    "import { useTranslations } from \"next-intl\";",
    "import { useTransition } from \"react\";",
    "import { Controller, useForm } from \"react-hook-form\";",
    "import { z } from \"zod\";",
    "",
    "import { useModal } from \"@/core/hooks/useModal\";",
    "import { useZodTranslation } from \"@/core/hooks/useZodTranslation\";",
    "import { useRouter } from \"@/i18n/navigation\";",
    "",
    "export function LoginForm() {",
    "  const t = useTranslations();",
    "  const router = useRouter();",
    "  const translateError = useZodTranslation();",
    "  const { openModal, closeModal } = useModal();",
    "  const [isPending, startTransition] = useTransition();",
    "",
    "  const schema = z.object({});",
    "",
    "  type SchemaProps = z.infer<typeof schema>;",
    "",
    "  const {",
    "    control,",
    "    handleSubmit,",
    "    formState: { errors },",
    "  } = useForm<SchemaProps>({",
    "    resolver: zodResolver(schema),",
    "    defaultValues: {},",
    "  });",
    "",
    "  async function onSubmit({ client, password, username }: SchemaProps) {",
    "    startTransition(async () => {});",
    "  }",
    "",
    "  return (",
    "    <form onSubmit={handleSubmit(onSubmit)}>",
    "    </form>",
    "  )",
    "}",
    ""
  ]
},
```

### üîñ Criar um componente que estende `<div>`
```json
"Creates a component that extends div": {
  "prefix": "component:div",
  "body": [
      "import { tv } from \"tailwind-variants\";",
      "",
      "type BaseProps = DetailedHTMLProps<HTMLAttributes<HTMLDivElement>, HTMLDivElement>;",
      "",
      "type $1Props = BaseProps & {}",
      "",
      "export function $1({ className, children, ...rest }: $1Props) {",
      "  return <div className={style({ className })} {...rest}>{children}</div>",
      "}",
      "",
      "const style = tv({",
      "  base: \"\",",
      "  variants: {},",
      "})",
      ""
  ]
},
```

### üìö Criar um Story para um componente
```json
"Creates a component story": {
  "prefix": "component:story",
  "body": [
    "import type { Meta, StoryObj } from \"@storybook/react\";",
    "import { fn, userEvent, within } from \"@storybook/test\";",
    "",
    "import { ${1:componentName} } from \"./\";",
    "",
    "export const ActionsData = {};",
    "",
    "const meta = {",
    "  tags: [\"autodocs\"],",
    "  args: { ...ActionsData },",
    "  title: \"${2:context}/${1:componentName}\",",
    "  component: ${1:componentName},",
    "  excludeStories: /.*Data$/,",
    "  argTypes: { },",
    "} satisfies Meta<typeof ${1:componentName}>;",
    "",
    "export default meta;",
    "",
    "type Story = StoryObj<typeof meta>;",
    "",
    "export const Default: Story = {",
    "  args: {},",
    "  play: async ({ canvasElement }) => {",
    "    const canvas = within(canvasElement);",
    "  }",
    "}"
  ]
}
```

## üîó Links √öteis

- üìñ [Biblioteca de Icones](https://react-icons.github.io/react-icons/search/)
- üìñ [Next.js - Framework](https://nextjs.org/docs)
- üìñ [NextIntl.js - Internacionaliza√ß√£o](https://nextjs.org/docs)
- üìñ [NextAuth.js - Authentica√ß√£o](https://next-auth.js.org)
- üìñ [Documenta√ß√£o do React](https://pt-br.react.dev)
- üìñ [Documenta√ß√£o do Storybook](https://storybook.js.org/)
- üìñ [Documenta√ß√£o do Tailwind CSS](https://tailwindcss.com/docs)
- üìñ [Documenta√ß√£o do Tailwind Variants](https://www.tailwind-variants.org)